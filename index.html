<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Script Timer</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body { background: #0D0F11; }
    textarea:focus { border-color: #2A3040 !important; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script>
const { useState, useMemo, useCallback } = React;

const WORDS_PER_MINUTE = 150;

const SECTION_COLORS = [
  "#4A90D9", "#D94A6B", "#50B87A", "#D9A64A", "#9B59B6",
  "#E67E22", "#1ABC9C", "#E74C3C", "#3498DB", "#2ECC71",
  "#F39C12", "#8E44AD", "#16A085", "#C0392B", "#2980B9",
];

function formatTime(seconds) {
  const mins = Math.floor(seconds / 60);
  const secs = Math.round(seconds % 60);
  if (mins === 0) return secs + "s";
  return secs > 0 ? mins + "m " + secs + "s" : mins + "m";
}

function formatTimeDetailed(seconds) {
  const mins = Math.floor(seconds / 60);
  const secs = Math.round(seconds % 60);
  return mins + ":" + secs.toString().padStart(2, "0");
}

function detectSections(text) {
  if (!text.trim()) return [];

  const lines = text.split("\n");
  const sections = [];
  let currentTitle = "Untitled Section";
  let currentLines = [];
  let sectionStarted = false;

  const isHeader = function(line) {
    const trimmed = line.trim();
    if (!trimmed) return false;
    if (/^#{1,6}\s+/.test(trimmed)) return true;
    if (trimmed.length <= 60 && trimmed === trimmed.toUpperCase() && /[A-Z]{2,}/.test(trimmed) && !/^\d+$/.test(trimmed)) return true;
    if (trimmed.length <= 60 && trimmed.endsWith(":")) return true;
    if (/^\[.+\]$/.test(trimmed)) return true;
    return false;
  };

  const cleanTitle = function(line) {
    return line.trim()
      .replace(/^#{1,6}\s+/, "")
      .replace(/^\[|\]$/g, "")
      .replace(/:$/, "")
      .trim();
  };

  for (let i = 0; i < lines.length; i++) {
    const line = lines[i];
    if (isHeader(line)) {
      if (sectionStarted && currentLines.some(function(l) { return l.trim(); })) {
        sections.push({ title: currentTitle, text: currentLines.join("\n").trim() });
      }
      currentTitle = cleanTitle(line);
      currentLines = [];
      sectionStarted = true;
    } else {
      if (!sectionStarted && line.trim()) sectionStarted = true;
      currentLines.push(line);
    }
  }

  if (currentLines.some(function(l) { return l.trim(); })) {
    sections.push({ title: currentTitle, text: currentLines.join("\n").trim() });
  }

  if (sections.length === 0 && text.trim()) {
    sections.push({ title: "Full Script", text: text.trim() });
  }

  return sections;
}

function countWords(text) {
  return text.trim().split(/\s+/).filter(function(w) { return w.length > 0; }).length;
}

const SAMPLE_SCRIPT = "INTRODUCTION\nWelcome to this overview of our latest product release. We've been working hard to bring you a solution that addresses the core challenges facing modern engineering teams. In this video, we'll walk you through everything you need to know to get started and show you why this release matters.\n\nKEY FEATURES\nThe new simulation engine runs three times faster than its predecessor. We've also added real-time collaboration, so your entire team can work on the same model simultaneously. The updated interface puts your most-used tools front and center.\n\nDEMO\nWatch as we set up a new project from scratch. First, we select our template. Then we import our data. The system automatically configures the optimal parameters. Notice how the results render in real time as we adjust variables.\n\nUSE CASES\nEngineering teams at automotive companies use this for crash simulation. Aerospace firms rely on it for computational fluid dynamics. And university researchers have adopted it for teaching complex mathematical concepts to students in ways that were never before possible with traditional tools.\n\nCALL TO ACTION\nStart your free trial today. Visit mathworks.com/trial to get started. Our team is standing by to help you onboard. Don't forget to subscribe to our channel for more product updates and tutorials. And if you found this video helpful, please share it with your colleagues who might benefit from learning about these powerful new capabilities we've introduced.";

function ScriptTimer() {
  const [rawText, setRawText] = useState("");
  const [editedSections, setEditedSections] = useState(null);
  const [hoveredIndex, setHoveredIndex] = useState(null);
  const [showHelp, setShowHelp] = useState(false);

  const autoSections = useMemo(function() { return detectSections(rawText); }, [rawText]);
  const sections = editedSections || autoSections;

  const analysisData = useMemo(function() {
    return sections.map(function(s, i) {
      const words = countWords(s.text);
      const seconds = (words / WORDS_PER_MINUTE) * 60;
      return Object.assign({}, s, { words: words, seconds: seconds, color: SECTION_COLORS[i % SECTION_COLORS.length] });
    });
  }, [sections]);

  const totalWords = analysisData.reduce(function(sum, s) { return sum + s.words; }, 0);
  const totalSeconds = analysisData.reduce(function(sum, s) { return sum + s.seconds; }, 0);

  const handlePaste = useCallback(function(text) {
    setRawText(text);
    setEditedSections(null);
  }, []);

  const handleLoadSample = function() {
    setRawText(SAMPLE_SCRIPT);
    setEditedSections(null);
  };

  const handleRenameSection = function(index, newTitle) {
    const updated = (editedSections || autoSections).slice();
    updated[index] = Object.assign({}, updated[index], { title: newTitle });
    setEditedSections(updated);
  };

  const hasContent = rawText.trim().length > 0;

  // Helper to create elements without JSX
  const h = React.createElement;

  return h("div", { style: { minHeight: "100vh", background: "#0D0F11", color: "#E0E4E8", fontFamily: "'JetBrains Mono', 'SF Mono', 'Fira Code', monospace" } },

    // Header
    h("div", { style: { borderBottom: "1px solid #1E2328", padding: "16px 24px", display: "flex", alignItems: "center", justifyContent: "space-between" } },
      h("div", { style: { display: "flex", alignItems: "center", gap: "12px" } },
        h("div", { style: { width: "8px", height: "8px", borderRadius: "50%", background: hasContent ? "#50B87A" : "#555", boxShadow: hasContent ? "0 0 8px #50B87A66" : "none" } }),
        h("span", { style: { fontSize: "13px", fontWeight: 700, letterSpacing: "2px", textTransform: "uppercase", color: "#8A9BB0" } }, "Script Timer"),
        h("span", { style: { fontSize: "10px", color: "#4A5568", letterSpacing: "1px" } }, "150 WPM")
      ),
      h("div", { style: { display: "flex", gap: "8px", alignItems: "center" } },
        h("button", { onClick: function() { setShowHelp(!showHelp); }, style: { background: "transparent", border: "1px solid #2A3040", color: "#8A9BB0", width: "24px", height: "24px", fontSize: "12px", borderRadius: "4px", cursor: "pointer", display: "flex", alignItems: "center", justifyContent: "center" } }, "?")
      )
    ),

    // Help panel
    showHelp && h("div", { style: { margin: "12px 24px", padding: "16px", background: "#141820", border: "1px solid #1E2328", borderRadius: "6px", fontSize: "12px", lineHeight: 1.7, color: "#8A9BB0" } },
      h("div", { style: { fontWeight: 700, color: "#E0E4E8", marginBottom: "8px" } }, "How it works"),
      h("div", null, "Paste a script and sections are auto-detected from:"),
      h("div", { style: { padding: "4px 0 4px 12px", color: "#6B7B8F" } },
        h("span", null, "\u2022 "), h("span", { style: { color: "#4A90D9" } }, "ALL CAPS LINES"), " \u2014 treated as section headers", h("br"),
        h("span", null, "\u2022 "), h("span", { style: { color: "#4A90D9" } }, "Lines ending with a colon:"), " \u2014 treated as section headers", h("br"),
        h("span", null, "\u2022 "), h("span", { style: { color: "#4A90D9" } }, "# Markdown headers"), " \u2014 treated as section headers", h("br"),
        h("span", null, "\u2022 "), h("span", { style: { color: "#4A90D9" } }, "[Bracketed labels]"), " \u2014 treated as section headers"
      ),
      h("div", { style: { marginTop: "6px" } }, "Click any section title to rename it. Edit the script text directly to add, remove, or move section breaks.")
    ),

    h("div", { style: { display: "flex", flexDirection: "column", gap: "0" } },

      // Input area
      h("div", { style: { padding: "16px 24px" } },
        h("div", { style: { display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: "8px" } },
          h("span", { style: { fontSize: "10px", color: "#4A5568", letterSpacing: "1px", textTransform: "uppercase" } }, "Script Input"),
          !hasContent && h("button", { onClick: handleLoadSample, style: { background: "transparent", border: "1px solid #2A3040", color: "#4A90D9", padding: "3px 8px", fontSize: "10px", borderRadius: "3px", cursor: "pointer", letterSpacing: "0.5px" } }, "LOAD SAMPLE"),
          hasContent && h("button", { onClick: function() { setRawText(""); setEditedSections(null); }, style: { background: "transparent", border: "1px solid #2A3040", color: "#D94A6B", padding: "3px 8px", fontSize: "10px", borderRadius: "3px", cursor: "pointer", letterSpacing: "0.5px" } }, "CLEAR")
        ),
        h("textarea", { value: rawText, onChange: function(e) { handlePaste(e.target.value); }, placeholder: "Paste your script here. Use ALL CAPS lines, lines ending with colons, # markdown headers, or [bracketed labels] for section breaks...", style: { width: "100%", minHeight: "160px", maxHeight: "300px", background: "#0A0C0E", border: "1px solid #1E2328", borderRadius: "6px", color: "#C0C8D0", padding: "14px", fontSize: "13px", fontFamily: "'JetBrains Mono', 'SF Mono', 'Fira Code', monospace", resize: "vertical", lineHeight: 1.6, outline: "none", boxSizing: "border-box" } })
      ),

      // Analysis output
      hasContent && analysisData.length > 0 && h(React.Fragment, null,

        // Timeline bar
        h("div", { style: { padding: "8px 24px 16px" } },
          h("div", { style: { display: "flex", justifyContent: "space-between", alignItems: "baseline", marginBottom: "10px" } },
            h("span", { style: { fontSize: "10px", color: "#4A5568", letterSpacing: "1px", textTransform: "uppercase" } }, "Timeline"),
            h("span", { style: { fontSize: "13px", color: "#E0E4E8", fontWeight: 600 } }, totalWords + " words \u2192 " + formatTimeDetailed(totalSeconds) + " total")
          ),
          h("div", { style: { display: "flex", height: "48px", borderRadius: "6px", overflow: "hidden", border: "1px solid #1E2328" } },
            analysisData.map(function(s, i) {
              const pct = totalSeconds > 0 ? (s.seconds / totalSeconds) * 100 : 0;
              const isHovered = hoveredIndex === i;
              return h("div", {
                key: i,
                onMouseEnter: function() { setHoveredIndex(i); },
                onMouseLeave: function() { setHoveredIndex(null); },
                style: { width: pct + "%", minWidth: pct > 0 ? "2px" : "0", background: isHovered ? s.color : s.color + "99", display: "flex", alignItems: "center", justifyContent: "center", transition: "all 0.15s ease", cursor: "default", position: "relative", borderRight: i < analysisData.length - 1 ? "1px solid #0D0F11" : "none", opacity: hoveredIndex !== null && !isHovered ? 0.4 : 1 }
              },
                (isHovered || pct > 6) && h("span", { style: { fontSize: "10px", fontWeight: 600, color: "#fff", textShadow: "0 1px 3px rgba(0,0,0,0.5)", whiteSpace: "nowrap", overflow: isHovered ? "visible" : "hidden", textOverflow: "ellipsis", padding: "0 6px", zIndex: isHovered ? 10 : 1, position: "relative" } }, s.title)
              );
            })
          ),
          h("div", { style: { display: "flex", justifyContent: "space-between", marginTop: "4px", fontSize: "10px", color: "#3A4558" } },
            h("span", null, "0:00"),
            totalSeconds > 30 && h("span", null, formatTimeDetailed(totalSeconds / 2)),
            h("span", null, formatTimeDetailed(totalSeconds))
          )
        ),

        // Section breakdown
        h("div", { style: { padding: "0 24px 24px" } },
          h("span", { style: { fontSize: "10px", color: "#4A5568", letterSpacing: "1px", textTransform: "uppercase", display: "block", marginBottom: "10px" } }, "Section Breakdown"),
          h("div", { style: { display: "flex", flexDirection: "column", gap: "4px" } },
            analysisData.map(function(s, i) {
              const pct = totalWords > 0 ? ((s.words / totalWords) * 100).toFixed(1) : "0.0";
              const isHovered = hoveredIndex === i;
              const isLong = s.seconds > totalSeconds * 0.35 && analysisData.length > 2;
              const isShort = s.seconds < 5 && totalSeconds > 30;

              return h("div", {
                key: i,
                onMouseEnter: function() { setHoveredIndex(i); },
                onMouseLeave: function() { setHoveredIndex(null); },
                style: { display: "grid", gridTemplateColumns: "6px 1fr auto", gap: "12px", alignItems: "center", padding: "10px 12px", background: isHovered ? "#141820" : "transparent", borderRadius: "6px", transition: "background 0.15s ease" }
              },
                h("div", { style: { width: "6px", height: "6px", borderRadius: "50%", background: s.color, boxShadow: isHovered ? "0 0 8px " + s.color + "66" : "none" } }),
                h("div", { style: { minWidth: 0 } },
                  h("div", { style: { display: "flex", alignItems: "center", gap: "8px" } },
                    h("input", { value: s.title, onChange: function(e) { handleRenameSection(i, e.target.value); }, title: "Click to rename section", style: { background: "transparent", border: "none", color: "#E0E4E8", fontSize: "13px", fontWeight: 600, fontFamily: "'JetBrains Mono', 'SF Mono', 'Fira Code', monospace", padding: "0", outline: "none", width: "100%", minWidth: "60px" } }),
                    (isLong || isShort) && h("span", { style: { fontSize: "9px", fontWeight: 700, letterSpacing: "0.5px", padding: "2px 6px", borderRadius: "3px", whiteSpace: "nowrap", background: isLong ? "#D94A6B22" : "#D9A64A22", color: isLong ? "#D94A6B" : "#D9A64A", border: "1px solid " + (isLong ? "#D94A6B44" : "#D9A64A44") } }, isLong ? "HEAVY" : "THIN")
                  ),
                  h("div", { style: { display: "flex", gap: "12px", marginTop: "4px", fontSize: "11px", color: "#4A5568" } },
                    h("span", null, s.words + " words"),
                    h("span", null, pct + "%")
                  )
                ),
                h("div", { style: { textAlign: "right", fontSize: "16px", fontWeight: 700, color: isHovered ? "#fff" : "#C0C8D0", fontVariantNumeric: "tabular-nums", whiteSpace: "nowrap" } }, formatTime(s.seconds))
              );
            })
          ),

          // Total
          h("div", { style: { marginTop: "12px", paddingTop: "12px", borderTop: "1px solid #1E2328", display: "grid", gridTemplateColumns: "6px 1fr auto", gap: "12px", alignItems: "center", padding: "12px 12px 0" } },
            h("div"),
            h("div", { style: { fontSize: "11px", color: "#8A9BB0", fontWeight: 600 } }, "TOTAL \u2014 " + totalWords + " words across " + analysisData.length + " section" + (analysisData.length !== 1 ? "s" : "")),
            h("div", { style: { fontSize: "16px", fontWeight: 700, color: "#50B87A", fontVariantNumeric: "tabular-nums" } }, formatTimeDetailed(totalSeconds))
          )
        )
      ),

      // Empty state
      !hasContent && h("div", { style: { display: "flex", flexDirection: "column", alignItems: "center", justifyContent: "center", padding: "60px 24px", color: "#2A3040" } },
        h("div", { style: { fontSize: "32px", marginBottom: "12px" } }, "\u25B6"),
        h("div", { style: { fontSize: "12px", letterSpacing: "1px" } }, "PASTE A SCRIPT TO BEGIN")
      )
    )
  );
}

const root = ReactDOM.createRoot(document.getElementById("root"));
root.render(React.createElement(ScriptTimer));
  </script>
</body>
</html>
